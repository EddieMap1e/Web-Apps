window.__require=function t(o,c,i){function e(s,a){if(!c[s]){if(!o[s]){var n=s.split("/");if(n=n[n.length-1],!o[n]){var h="function"==typeof __require&&__require;if(!a&&h)return h(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+s+"'")}s=n}var l=c[s]={exports:{}};o[s][0].call(l.exports,function(t){return e(o[s][1][t]||t)},l,l.exports,t,o,c,i)}return c[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<i.length;s++)e(i[s]);return e}({block:[function(t,o,c){"use strict";cc._RF.push(o,"42384kYmk9PgagxBGi82/DP","block");var i=[];i[0]=cc.color(198,184,172,255),i[2]=cc.color(235,224,213,255),i[4]=cc.color(234,219,193,255),i[8]=cc.color(240,167,110,255),i[16]=cc.color(244,138,89,255),i[32]=cc.color(245,112,85,255),i[64]=cc.color(245,83,52,255),i[128]=cc.color(234,200,103,255),i[256]=cc.color(234,197,87,255),i[512]=cc.color(234,192,71,255),i[1024]=cc.color(146,200,80,255),i[2048]=cc.color(0,176,240,255),cc.Class({extends:cc.Component,properties:{numberLabel:cc.Label},start:function(){},setNumber:function(t){0==t&&(this.numberLabel.node.active=!1),this.numberLabel.string=t,t in i&&(this.node.color=i[t])}}),cc._RF.pop()},{}],gameMain:[function(t,o,c){"use strict";cc._RF.push(o,"ddf543sxzVA6IkVtKmSBfk7","gameMain");cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,score:0,blockPrefab:cc.Prefab,gap:20,row:4,bg:cc.Node},start:function(){this.row=parseInt(cc.sys.localStorage.getItem("gameMode")),this.drawBgBlocks(),this.init(),this.addEventListener()},drawBgBlocks:function(){this.blockSize=(cc.winSize.width-this.gap*(this.row+1))/this.row;var t=this.gap+this.blockSize/2,o=this.blockSize;this.position=[];for(var c=0;c<this.row;c++){this.position.push([]);for(var i=0;i<this.row;i++)this.position[c].push(0);for(var e=0;e<this.row;e++){var r=cc.instantiate(this.blockPrefab);r.width=this.blockSize,r.height=this.blockSize,this.bg.addChild(r),r.setPosition(cc.Vec2(t,o)),this.position[c][e]=[t,o],t+=this.gap+this.blockSize,r.getComponent("block").setNumber(0)}o+=this.gap+this.blockSize,t=this.gap+this.blockSize/2}},init:function(){if(this.updateScore(0),this.blocks)for(var t=0;t<this.row;t++)for(var o=0;o<this.row;o++)null!=this.blocks[t][o]&&this.blocks[t][o].destroy();this.data=[],this.blocks=[];for(var c=0;c<this.row;c++){this.blocks.push([]),this.data.push([]);for(var i=0;i<this.row;i++)this.blocks[c].push(null),this.data[c].push(0)}for(var e=0;e<3;e++)this.addBlock()},updateScore:function(t){this.score=t,this.scoreLabel.string="\u5206\u6570 : "+t},getEmptyPos:function(){for(var t=[],o=0;o<this.row;o++)for(var c=0;c<this.row;c++)0==this.data[o][c]&&t.push([o,c]);return t},addBlock:function(){var t=this.getEmptyPos();if(0!=t.length){var o=t[Math.floor(Math.random()*t.length)],c=cc.instantiate(this.blockPrefab);c.width=this.blockSize,c.height=this.blockSize,this.bg.addChild(c);var i=this.position[o[0]][o[1]][0],e=this.position[o[0]][o[1]][1];c.setPosition(cc.Vec2(i,e));var r=Math.random()<=.5?2:4;c.getComponent("block").setNumber(r),this.data[o[0]][o[1]]=r,this.blocks[o[0]][o[1]]=c}},addEventListener:function(){var t=this;this.bg.on("touchstart",function(o){t.startPoint=o.getLocation()}),this.bg.on("touchend",function(o){t.touchEnd(o)}),this.bg.on("touchcancel",function(o){t.touchEnd(o)})},touchEnd:function(t){this.endPoint=t.getLocation();var o=this.endPoint.subSelf(this.startPoint);cc.Vec2.len(this.endPoint,this.startPoint)>50&&(Math.abs(o.x)>Math.abs(o.y)?o.x>0?this.moveDir(4):this.moveDir(3):o.y>0?this.moveDir(1):this.moveDir(2))},checkFail:function(){for(var t=0;t<this.row;t++)for(var o=0;o<this.row;o++){var c=this.data[t][o];if(0==c)return!1;if(o>0&&this.data[t][o-1]==c)return!1;if(o<this.row-1&&this.data[t][o+1]==c)return!1;if(t>0&&this.data[t-1][o]==c)return!1;if(t<this.row-1&&this.data[t+1][o]==c)return!1}return!0},gameOver:function(){cc.sys.localStorage.setItem("failScore",this.score),cc.director.loadScene("gameOver")},afterMove:function(t){t&&(this.addBlock(),this.updateScore(this.score+1)),this.checkFail()&&this.gameOver()},moveBlock:function(t,o,c){var i=cc.moveTo(.1,o),e=cc.callFunc(function(){c&&c()});t.runAction(cc.sequence(i,e))},moveDir:function(t){var o=this,c=[],i=0,e=0,r=-1,s=-1;if(1==t){i=1,r=this.row-1;for(var a=this.row-1;a>=0;a--)for(var n=0;n<this.row;n++)c.push([a,n])}else if(2==t){i=-1,r=0;for(var h=0;h<this.row;h++)for(var l=0;l<this.row;l++)c.push([h,l])}else if(3==t){e=-1,s=0;for(var u=0;u<this.row;u++)for(var f=0;f<this.row;f++)c.push([u,f])}else if(4==t){e=1,s=this.row-1;for(var d=0;d<this.row;d++)for(var p=this.row-1;p>=0;p--)c.push([d,p])}for(var b=!1,g=function t(c,a,n){if(c!=r&&a!=s&&0!=o.data[c][a])if(0==o.data[c+i][a+e]){var h=o.blocks[c][a],l=o.position[c+i][a+e];o.blocks[c+i][a+e]=h,o.data[c+i][a+e]=o.data[c][a],o.blocks[c][a]=null,o.data[c][a]=0,o.moveBlock(h,cc.Vec2(l[0],l[1]),function(){t(c+i,a+e,n)}),b=!0}else{if(o.data[c+i][a+e]==o.data[c][a]){var u=o.blocks[c][a],f=o.position[c+i][a+e];return o.data[c+i][a+e]<<=1,o.updateScore(o.score+o.data[c+i][a+e]),o.blocks[c+i][a+e].getComponent("block").setNumber(o.data[c+i][a+e]),o.blocks[c][a]=null,o.data[c][a]=0,o.moveBlock(u,cc.Vec2(f[0],f[1]),function(){u.destroy()}),b=!0,void(n&&n())}n&&n()}else n&&n()},v=0,m=0;m<c.length;m++)g(c[m][0],c[m][1],function(){++v==c.length&&o.afterMove(b)})}}),cc._RF.pop()},{}],gameOver:[function(t,o,c){"use strict";cc._RF.push(o,"f7759tOPaxGVrT/KD0J1D2/","gameOver"),cc.Class({extends:cc.Component,properties:{bestScore:cc.Label,failScore:cc.Label},start:function(){this.init()},init:function(){var t=cc.sys.localStorage.getItem("failScore");"null"===t&&(t=0),cc.log(t),this.failScore.string="\u5206\u6570 : "+t;var o=cc.sys.localStorage.getItem("bestScore");("null"===o||parseInt(t)>parseInt(o))&&(o=t),cc.sys.localStorage.setItem("bestScore",o),this.bestScore.string="\u6700\u9ad8\u5206 : "+o,cc.log(o)},retry:function(t,o){cc.director.loadScene("gameStart")}}),cc._RF.pop()},{}],gameSelect:[function(t,o,c){"use strict";cc._RF.push(o,"7a8c8sK7LVJm5y+g0r57cBi","gameSelect"),cc.Class({extends:cc.Component,properties:{},start:function(){},mode:function(t,o){cc.sys.localStorage.setItem("gameMode",o),cc.director.loadScene("gameStart")}}),cc._RF.pop()},{}]},{},["block","gameMain","gameOver","gameSelect"]);